CheckListWin - cài đặt SSH, không cho phép ROOT SSH, cấm IP

## 1 Checklist cho Windows Server mức độ cơ bản!

| STT | Guidance | Explanation | How-To | Image Demo  |
|------|-----------------------------------|-----------------------------------|-----------------------------|-----------------------|
| 1    | Install the latest service packs and hotfixes from Microsoft. <br> Cài đặt các gói dịch vụ và bản vá lỗi mới nhất từ Microsoft. | Đảm bảo hệ thống luôn cập nhật các bản vá bảo mật quan trọng, giảm thiểu nguy cơ từ các lỗ hổng bảo mật đã biết. Các gói dịch vụ và bản vá thường chứa các cập nhật bảo mật và sửa lỗi hệ thống. | Mở **Windows Update** và kiểm tra xem thiết bị của bạn đã cài đặt các bản cập nhật mới nhất chưa. | <img src="https://img001.prntscr.com/file/img001/mL1XnhemT0aTwFQ3VKpjTQ.png" width="100000"/> |
| 2    | Enable automatic notification of patch availability. <br> Bật thông báo tự động khi có bản vá mới. | Thiết lập hệ thống để nhận thông báo khi có bản vá hoặc cập nhật mới từ Microsoft, giúp quản trị viên nhanh chóng biết và áp dụng các bản vá quan trọng. | Tìm kiếm **Notification & Acction Setting** trên thanh tìm kiếm. | ![](https://img001.prntscr.com/file/img001/zvotP2I_SEOQ78bhU_Si7A.png) |
| 3    | Set minimum password length. <br> Đặt độ dài mật khẩu tối thiểu. | Cấu hình độ dài tối thiểu cho mật khẩu nhằm đảm bảo mật khẩu đủ phức tạp và khó bị đoán. Đề xuất độ dài ít nhất 8 ký tự. |**Computer Configuration > Windows Settings > Security Settings > Account Policies > Password Policy.** Cấu hình **Minimum Password Length** để yêu cầu độ dài tối thiểu (thường là 8 ký tự trở lên).  | ![Image3](https://img001.prntscr.com/file/img001/V_xnGEw5Txi6GeGMMsvcRQ.png) |
| 4    | Enable password complexity requirements. <br> Bật yêu cầu độ phức tạp của mật khẩu. | Đảm bảo mật khẩu bao gồm các ký tự đa dạng (chữ hoa, chữ thường, số, ký tự đặc biệt) để tăng tính bảo mật và ngăn ngừa tấn công dò mật khẩu. |    Trong cùng mục **Password Policy**, bật tùy chọn **Password must meet complexity requirements.**  | ![Image4](https://img001.prntscr.com/file/img001/-D6PpZMfTwSKrwKGzKm3CQ.png) ![](https://img001.prntscr.com/file/img001/gWHcW-jySZ-uefWlw1rhrg.png) |
| 5    | Do not store passwords using reversible encryption. (Default) <br> Không lưu trữ mật khẩu bằng mã hóa có thể đảo ngược. (Mặc định) | Mật khẩu không nên được lưu trữ dưới dạng có thể giải mã, vì điều này tạo ra nguy cơ lộ mật khẩu nếu hệ thống bị tấn công. |  DES, AES, RC4, RC5,...<BR> => RSA,SHA, MD5,...| ![Image5](https://img001.prntscr.com/file/img001/Gri1swuKSuOUM026tG7sEg.png) |
| 6    | Configure account lockout policy. <br> Cấu hình chính sách khóa tài khoản. | Tài khoản bị khóa sau một số lần đăng nhập thất bại để ngăn chặn các cuộc tấn công brute force. Thiết lập này bảo vệ hệ thống khỏi việc đoán mật khẩu liên tục. | Trong **Account Policies, chọn Account Lockout Policy**. Đặt các tham số như **Account lockout threshold** (ví dụ: 5 lần đăng nhập sai) và thời gian khóa tài khoản.    | ![Image6](https://img001.prntscr.com/file/img001/UziSxM4JT8qrGo_puuQNTA.png) ![](https://img001.prntscr.com/file/img001/kq00yLp9TZm6hSCc6ptpMQ.png) |
| 7    | Restrict the ability to access this computer from the network to Administrators and Authenticated Users. <br> Hạn chế quyền truy cập từ mạng chỉ cho quản trị viên và người dùng xác thực. | Chỉ những người dùng có quyền quản trị và đã xác thực mới được phép truy cập từ xa vào hệ thống, giúp bảo vệ hệ thống khỏi truy cập trái phép từ mạng. | Điều hướng đến **Local Policies > User Rights Assignment**.Nhấn đúp vào **Access this computer from the network** và thêm **Administrators, Authenticated Users**.   | ![Image7](https://img001.prntscr.com/file/img001/K7tYDwXAQ6yTkjBwvbhl4w.png) ![](https://img001.prntscr.com/file/img001/qbvqG_x2Qu2GWdlIndh6Kw.png) |
| 8    | Do not grant any users the 'act as part of the operating system' right. (Default) <br> <br> Không cấp quyền 'hoạt động như một phần của hệ điều hành' cho người dùng. (Mặc định) |Việc cấp quyền người dùng không phù hợp có thể mang lại khả năng hệ thống, quản trị và các khả năng cấp cao khác. Các tài khoản có quyền người dùng "Hoạt động như một phần của hệ điều hành" có thể mang danh tính của bất | kỳ người dùng nào và có quyền truy cập vào các tài nguyên mà người dùng được phép truy cập. Bất kỳ tài khoản nào có quyền này đều có thể kiểm soát hoàn toàn hệ thống. Nên ta sẽ tắt, kể cả admin vì admin đã có đủ quyền rồi! <br><br> **User Rights Assignment**. Tìm mục **Act as part of the operating system** và đảm bảo không có người dùng nào trong danh sách.    | ![Image8](https://img001.prntscr.com/file/img001/qEFPvooPQMKQGSS75Pwxiw.png) |
| 9    | Restrict local logon access to Administrators. <br> Hạn chế quyền đăng nhập cục bộ chỉ cho quản trị viên. | Chỉ cho phép quản trị viên đăng nhập trực tiếp tại máy chủ để ngăn chặn người dùng trái phép truy cập vật lý vào hệ thống. | Tìm **Deny log on locally** trong **User Rights Assignment**.Thêm người dùng không mong muốn và đảm bảo Administrators có trong danh sách.   | ![Image9](https://img001.prntscr.com/file/img001/JjYouSwjSneg4KH9JieCdA.png) |
| 10   | Deny guest accounts the ability to logon as a service, batch job, locally or via RDP. <br> Từ chối quyền đăng nhập cho tài khoản khách dưới dạng dịch vụ, batch job, tại chỗ hoặc qua RDP. | Ngăn chặn tài khoản khách có quyền thực hiện các tác vụ quan trọng như chạy dịch vụ, batch job, hoặc đăng nhập từ xa để giảm nguy cơ bảo mật. |  Vào **Local Policies > User Rights Assignment**. Tìm **Deny log on as a service, Deny log on locally, và Deny log on through Remote Desktop Services**. Thêm nhóm Guests vào tất cả các mục này.     | ![Image10](https://img001.prntscr.com/file/img001/ax_X4mAKT4qiZKOYdA07Rg.png)  ![](https://img001.prntscr.com/file/img001/jxwtE6lTRp6RYvZ-jT1egA.png) |
| 11   | Place the warning banner in the Message Text for users attempting to log on. <br> Đặt thông báo cảnh báo khi người dùng cố gắng đăng nhập. | Thông báo cảnh báo hoặc pháp lý khi người dùng cố gắng đăng nhập vào hệ thống, giúp cảnh báo về việc truy cập không hợp lệ hoặc trái phép. |  Vào `Local Policies > Security Options`. Tìm `Interactive logon: Message text for users attempting to log on`. Nhập văn bản cảnh báo muốn hiển thị cho người dùng.     | ![](https://img001.prntscr.com/file/img001/8K5HLfVQTAOx-K41PA_pLg.png)   ![](https://img001.prntscr.com/file/img001/zDsX-xLJQ0aQr2dh3Px9Uw.png) |
| 12   | Disallow users from creating and logging in with Microsoft accounts. <br> Không cho phép người dùng tạo và đăng nhập bằng tài khoản Microsoft. | Ngăn chặn người dùng tạo hoặc liên kết tài khoản Microsoft cá nhân vào hệ thống, giúp quản lý tài khoản dễ dàng hơn và giảm nguy cơ bảo mật từ tài khoản bên ngoài. | ![HowTo12] | ![](https://img001.prntscr.com/file/img001/L75z2T8yQj-cRHOvlNL7cg.png)  ![](https://img001.prntscr.com/file/img001/IXwi-IkvSG26fsR8p9fm1Q.png)        |
| 13   | Disable the guest account. (Default) <br> Vô hiệu hóa tài khoản khách. (Mặc định) | Tài khoản khách là một lỗ hổng bảo mật phổ biến, cần được vô hiệu hóa để ngăn ngừa truy cập trái phép vào hệ thống. |  **Local Policies** >>Security Options >> **"Accounts: Guest account status" to "Disabled" **  | ![Image13](https://img001.prntscr.com/file/img001/b0CIaMHaS6qknqo3lLOpjw.png) |
| 14   | Require Ctrl+Alt+Del for interactive logins. (Default) <br> Yêu cầu Ctrl+Alt+Del cho các đăng nhập tương tác. (Mặc định) | Tăng cường bảo mật cho quá trình đăng nhập bằng cách yêu cầu tổ hợp phím này trước khi hiển thị màn hình đăng nhập. | Yêu cầu này giúp ngăn chặn các phần mềm độc hại hoặc các chương trình giả mạo (phishing) hiển thị giao diện đăng nhập giả mạo. Chỉ khi người dùng nhấn Ctrl + Alt + Del, họ mới có thể truy cập vào giao diện đăng nhập hợp pháp của Windows. | ![Image14](https://img001.prntscr.com/file/img001/EY5bqGyiT3CM_mttcHFh9A.png) |
| 15   | Configure machine inactivity limit to protect idle interactive sessions. <br> Cấu hình giới hạn thời gian không hoạt động để bảo vệ các phiên tương tác không hoạt động. | Hệ thống sẽ tự động khóa nếu không có tương tác sau một thời gian để ngăn chặn truy cập trái phép vào các phiên đang hoạt động. | Để bật  **Interactive logon: Machine inactivity limit security policy setting có thể truy cập GPO/Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options.** |    ![](https://img001.prntscr.com/file/img001/6mKBsMG9Sh2AqN0CR6iQcQ.png)       |
| 16   | Configure Microsoft Network Client to always digitally sign communications. <br> Cấu hình Microsoft Network Client luôn ký số các liên lạc. | Ký số các liên lạc để đảm bảo tính toàn vẹn và an ninh của dữ liệu khi truyền qua mạng. Điều này giúp bảo vệ dữ liệu khỏi bị giả mạo. |   |
| 17   | Configure Microsoft Network Client to digitally sign communications if server agrees. (Default) <br> Cấu hình Microsoft Network Client ký số các liên lạc nếu máy chủ đồng ý. (Mặc định) | Ký số các liên lạc khi máy chủ hỗ trợ, giúp tăng cường bảo mật cho quá trình truyền dữ liệu trong mạng nội bộ. |    Điều hướng đến: **Computer Configuration > Windows Settings > Security Settings > Local Policies > Security Options**.Tìm `Microsoft network client: Digitally sign communications (always)` và thiết lập là `Enabled`.  | ![](https://img001.prntscr.com/file/img001/LOT965eqSWetrtdIG622Sw.png) |
| 18   | Disable the sending of unencrypted passwords to third party SMB servers. <br> Vô hiệu hóa việc gửi mật khẩu chưa mã hóa đến các máy chủ SMB bên thứ ba. | Ngăn ngừa việc gửi mật khẩu dưới dạng không mã hóa tới các máy chủ SMB bên thứ ba, giảm nguy cơ lộ mật khẩu trong quá trình truyền tải. | **Computer Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options.**   | ![](https://img001.prntscr.com/file/img001/F_6d9KUQTgeWO0fQFOUSnQ.png)|
| 19   | Configure Microsoft Network Server to always digitally sign communications. <br> Cấu hình Microsoft Network Server luôn ký số các liên lạc. | Ký số các liên lạc trên máy chủ giúp đảm bảo tính toàn vẹn và bảo mật của dữ liệu khi truyền qua mạng. | |  |
| 20   | Configure Microsoft Network Server to digitally sign communications if client agrees. <br> Cấu hình Microsoft Network Server ký số các liên lạc nếu máy khách đồng ý. | Khi máy khách hỗ trợ, máy chủ sẽ ký số các liên lạc để bảo vệ dữ liệu khi truyền tải qua mạng nội bộ. |**Computer Configuration >> Windows Settings >> Security Settings >> Local Policies >> Security Options >>**   | ![](https://img001.prntscr.com/file/img001/MqB2p5kZQpK1jL94FweR-g.png) |
| 21   | Disable anonymous SID/Name translation. (Default) <br> Vô hiệu hóa dịch SID/Name ẩn danh. (Mặc định) | Ngăn chặn người dùng ẩn danh truy cập và dịch SID (Security Identifier) thành tên, giúp bảo vệ danh tính người dùng và dữ liệu của họ. | Vẫn ở trong Sercurity Options thui | ![](https://img001.prntscr.com/file/img001/xAjbBqYcR-iu9NDUfCZgKw.png) |
| 22   | Do not allow anonymous enumeration of SAM accounts. (Default) <br> Không cho phép liệt kê tài khoản SAM ẩn danh. (Mặc định) | Tăng cường bảo mật bằng cách ngăn chặn các cuộc tấn công liệt kê thông tin tài khoản thông qua các yêu cầu ẩn danh. |  |Ảnh phía dưới bao gồm cả 2|
| 23   | Do not allow anonymous enumeration of SAM accounts and shares. <br> Không cho phép liệt kê tài khoản và chia sẻ ẩn danh. | Đảm bảo tài khoản và các chia sẻ mạng không bị truy cập hoặc liệt kê thông tin bởi các người dùng ẩn danh. |  Vẫn ở trong Sercurity Options thui |![](https://img001.prntscr.com/file/img001/hbyz-0JHQTqFZUS2FwGTMw.png) |
| 24   | Do not allow everyone permissions to apply to anonymous users. (Default) <br> Không cho phép quyền "everyone" áp dụng cho người dùng ẩn danh. (Mặc định) | Chỉ những người dùng xác thực mới được phép truy cập các tài nguyên được phân quyền, giúp ngăn ngừa truy cập trái phép từ người dùng ẩn danh. | **Configuration -> Windows Settings -> Security Settings -> Local Policies -> Security Options -> “Network access: Let everyone permissions apply to anonymous users” to “Disabled”**      | ![](https://img001.prntscr.com/file/img001/E_x_2in5Se-wrva1BlYbuA.png) |
| 25   | Do not allow any named pipes to be accessed anonymously. <br> Không cho phép truy cập ẩn danh vào các named pipes. | Ngăn chặn việc truy cập các kênh truyền thông của hệ thống thông qua kết nối ẩn danh, giúp bảo vệ các tiến trình quan trọng. |Bảo Vệ Dữ Liệu Nhạy Cảm: Named pipes thường được sử dụng để truyền thông giữa các ứng dụng hoặc tiến trình trong hệ thống. Nếu người dùng ẩn danh có quyền truy cập vào các ống dẫn này, dữ liệu nhạy cảm có thể bị lộ hoặc bị can thiệp. <br>Ta click  **Network access: Named Pipes that can be accessed anonymously** |![](https://img001.prntscr.com/file/img001/tjmCJLczQailFiWtttulug.png)    <br> <br>   ![](https://img001.prntscr.com/file/img001/yGoPsujAT4uJOuUGA_hB3A.png)    ![](https://img001.prntscr.com/file/img001/4XhOnY5KRV662qG43ehPKw.png)      |
| 26   | Restrict anonymous access to named pipes and shares. (Default) <br> Hạn chế truy cập ẩn danh vào named pipes và chia sẻ. (Mặc định) | Đảm bảo chỉ người dùng có xác thực mới có thể truy cập các named pipes và chia sẻ, bảo vệ tài nguyên mạng khỏi bị truy cập trái phép. |  **Local Policies >> Security Options >> "Network access: Restrict anonymous access to Named Pipes and Shares" to "Enabled".**  |![](https://img001.prntscr.com/file/img001/209SNqw8SdC7yvQp62RlXA.png) |
| 27   | Do not allow any shares to be accessed anonymously. <br> Không cho phép truy cập ẩn danh vào bất kỳ chia sẻ nào. | Ngăn chặn việc truy cập không xác thực vào các chia sẻ trên hệ thống, bảo vệ dữ liệu và tài nguyên chia sẻ mạng khỏi truy cập không an toàn. |   **Local Policies -> Security Options -> "Network access: Shares that can be accessed anonymously" contains no entries (blank).** |![](https://img001.prntscr.com/file/img001/Sb1Tg2GHRbWl7odWrOMSSA.png) |
| 28   | Require the "Classic" sharing and security model for local accounts. (Default) <br> Yêu cầu mô hình chia sẻ và bảo mật “Classic” cho tài khoản cục bộ. (Mặc định) | Sử dụng mô hình chia sẻ và bảo mật cổ điển giúp đảm bảo quyền truy cập được quản lý nghiêm ngặt hơn, không cho phép quyền chia sẻ không an toàn. | **Local Policies -> Security Options -> "Network access: Sharing and security model for local accounts" to "Classic - local users authenticate as themselves".**  | ![](https://img001.prntscr.com/file/img001/QoZLezEXTnO7WDc_KYwvFA.png) |
| 29   | Allow Local System to use computer identity for NTLM. <br> Cho phép Local System sử dụng danh tính máy tính cho NTLM. | Cấu hình này giúp đảm bảo hệ thống sử dụng thông tin xác thực an toàn cho NTLM (NT LAN Manager), cải thiện bảo mật xác thực. | ![HowTo29] |![](https://img001.prntscr.com/file/img001/yJKBplo_RsqKN6tZEbaFmg.png) |
| 30   | Disable Local System NULL session fallback. <br> Vô hiệu hóa fallback session NULL của Local System. | Ngăn chặn việc sử dụng các session NULL (không có thông tin xác thực) khi hệ thống thất bại trong việc xác thực, tăng cường bảo mật cho các kết nối hệ thống. |Việc ngăn chặn các phiên NULL giảm thiểu nguy cơ từ các cuộc tấn công như tấn công lặp lại (replay attacks) <br> **Local Policies -> Security Options -> "Network Security: Allow LocalSystem NULL session fallback" to "Disabled".** <br> [S-NULL-attack](https://quantrimang.com/cong-nghe/tim-hieu-tan-cong-null-session-63563)| ![](https://img001.prntscr.com/file/img001/bhi4D9nqSLeUAygR-QS36Q.png) |
| 31   | Configure allowable encryption types for Kerberos. <br> Cấu hình các loại mã hóa được phép cho Kerberos. | Chọn các thuật toán mã hóa mạnh nhất cho Kerberos nhằm đảm bảo quá trình xác thực an toàn và giảm thiểu nguy cơ tấn công mã hóa. | **Local Policies >> Security Options >> "Network security: Configure encryption types allowed for Kerberos" to "Enabled" with only the following selected:** **AES128_HMAC_SHA1 AES256_HMAC_SHA1**   <br> Kerberos > ntml. Nếu ta bật cả 2 giao thức xác thực này thì OS sẽ ưu tiên dùng Kerberos. Nếu Kerberos fail nó sẽ chuyển san NTLM.  | ![](https://img001.prntscr.com/file/img001/OURlVTQmSvq2BpaNOuTPLA.png) |
| 32   | Do not store LAN Manager hash values. <br> Không lưu trữ giá trị băm của LAN Manager. | Lưu trữ hash LAN Manager là một điểm yếu bảo mật. | LM hash sử dụng một thuật toán mã hóa cũ, yếu và dễ bị bẻ khóa. Khi lưu trữ giá trị băm LM, các mật khẩu có thể dễ dàng bị tấn công bằng các phương pháp như brute-force hoặc tấn công từ điển. Không lưu trữ các giá trị băm LM giúp bảo vệ mật khẩu tốt hơn.| Ảnh phía dưới bao gồm cả 2 mục |
| 33   | Set LAN Manager authentication level to only allow NTLMv2 and refuse LM and NTLM. <br> Đặt mức xác thực LAN Manager chỉ cho phép NTLMv2 và từ chối LM và NTLM. |NTLMv2 sử dụng các thuật toán mã hóa mạnh hơn so với LM và NTLM. Điều này làm cho NTLMv2 khó bị bẻ khóa hơn nhiều, giúp bảo vệ mật khẩu người dùng tốt hơn khỏi các cuộc tấn công brute-force hoặc từ điển. |  **Local Policies >> Security Options >> "Network security: LAN Manager authentication level" to "Send NTLMv2 response only. Refuse LM & NTLM".**    | ![](https://img001.prntscr.com/file/img001/mVGKQe7jRvST0CvfF9lwGA.png)  |
| 34   | Enable the Windows Firewall in all profiles (domain, private, public). (Default) <br> Bật tường lửa Windows trong tất cả các cấu hình (miền, riêng tư, công cộng). (Mặc định) | Kích hoạt tường lửa để bảo vệ hệ thống khỏi các cuộc tấn công từ mạng, đảm bảo rằng tất cả các kiểu kết nối đều được kiểm soát chặt chẽ. |Ta `ON` hết các lựa chọn lên **omputer Configuration -> Windows Settings -> Security Settings -> Windows Firewall with Advanced Security -> Windows Firewall with Advanced Security -> Windows Firewall Properties (this link will be in the right pane) -> Private Profile Tab -> State, “Firewall State” to “On (recommended)”.**   | ![](https://img001.prntscr.com/file/img001/S2ozGZztTIaaafTl9hlIHg.png) |
| 35   | Configure the Windows Firewall in all profiles to block inbound traffic by default. (Default) <br> Cấu hình tường lửa Windows trong tất cả các hồ sơ để chặn lưu lượng vào theo mặc định. (Mặc định) | Cấu hình mặc định này giúp ngăn chặn mọi truy cập không mong muốn từ bên ngoài trừ khi được phép cụ thể, giúp bảo vệ hệ thống khỏi tấn công. | |Như ảnh trên ở tất cả các mục  |
| 36   | Configure Windows Firewall to restrict remote access services (VNC, RDP, etc.) to authorized organization-only networks. <br> Cấu hình tường lửa Windows để giới hạn các dịch vụ truy cập từ xa (VNC, RDP, v.v.) chỉ với mạng được tổ chức ủy quyền. | Đảm bảo rằng chỉ các mạng nội bộ hoặc VPN của tổ chức mới được phép truy cập vào các dịch vụ như VNC hoặc RDP, giúp bảo vệ hệ thống khỏi các truy cập từ xa trái phép. | Start > Run and type firewall<br>Click on the Advanced Settings in the left pane<br>Click on the Inbound Rules <br>In left pane, click on New rule. <br>Under Rule Type select option Port and click next. <br>Select TCP and or UDP specific local ports options. <br>Allow the connection <br>Select the profile in use <br>Give the rule some meaningful name| ![](https://img001.prntscr.com/file/img001/Qu4hau27Ss-eZNIRqdp1Ug.png) <br><br>  <hr> ![](https://img001.prntscr.com/file/img001/QyGs-U5zRMKiNn42N6XKiw.png) <hr> ![](https://img001.prntscr.com/file/img001/Ws52KCkqSqCVmc2dE8mlDg.png) |
| 37   | Configure Windows Firewall to restrict remote access services (VNC, RDP, etc.) to the organization VPN. <br> Cấu hình tường lửa Windows để giới hạn các dịch vụ truy cập từ xa (VNC, RDP, v.v.) chỉ với VPN của tổ chức. | Thêm một lớp bảo mật bằng cách chỉ cho phép truy cập từ xa thông qua mạng VPN của tổ chức, đảm bảo tính bảo mật cho các kết nối từ xa. |  | Giống như trên ha|
| 38   | Digitally encrypt or sign secure channel data (always). (Default) <br> Mã hóa hoặc ký số dữ liệu kênh bảo mật (luôn luôn). (Mặc định) | Đảm bảo dữ liệu truyền qua các kênh bảo mật được mã hóa hoặc ký số để bảo vệ tính toàn vẹn và bảo mật của dữ liệu. | **Computer Configuration >> Windows Settings >> Security Settings >> Local Policies >> Security Options >> "Domain member: Digitally encrypt or sign secure channel data (always)" to "Enabled".**| ![Image38](https://img001.prntscr.com/file/img001/oFOvEFhaQZmKSdAd8L7W2Q.png) |
| 39   | Configure machine inactivity limit to protect idle interactive sessions. <br> Cấu hình giới hạn không hoạt động của máy để bảo vệ các phiên tương tác không hoạt động. | Máy chủ sẽ tự động khóa các phiên đang hoạt động nhưng không được sử dụng sau một khoảng thời gian nhất định, giúp ngăn ngừa truy cập trái phép vào các phiên bị bỏ quên. |**Local Policies -> Security Options -> "Interactive logon: Machine inactivity limit" to "300" seconds" or less, excluding "0" which is effectively disabled.** |![](https://img001.prntscr.com/file/img001/rGaV2Tk9Te25Bsw_IzfFKg.png) |
| 40   | Require strong (Windows 2000 or later) session keys. <br> Yêu cầu khóa phiên mạnh (Windows 2000 trở lên). | Yêu cầu sử dụng các khóa phiên mạnh giúp mã hóa và bảo vệ thông tin trong quá trình kết nối, đảm bảo an toàn cho các phiên truy cập mạng. | Kerberos, NTLMv2 |![](https://img001.prntscr.com/file/img001/ozx9bHgTTJehpQlZnOAA8Q.png)|
| 41   | Configure the number of previous logons to cache. <br> Cấu hình số lượng đăng nhập trước đó được lưu trữ. | Thiết lập giới hạn số lần đăng nhập trước đó được lưu trữ để giảm nguy cơ tấn công, bảo vệ lịch sử đăng nhập của người dùng. |Chỉ nên lưu trữ một số lượng nhỏ các lần đăng nhập trước đó, ví dụ như 1-2 lần, để giảm thiểu rủi ro nếu thiết bị bị mất. Điều này vẫn đủ để người dùng có thể đăng nhập khi không có mạng mà không làm tăng nguy cơ bảo mật. <BR> **Local Policies -> Security Options -> "Interactive Logon: Number of previous logons to cache (in case Domain Controller is not available)" to "2" logons or less.**  |![](https://img001.prntscr.com/file/img001/6GeLxJ6LQGGFnCunRHbntg.png) |
| 42   | Configure Account Logon audit policy. <br> Cấu hình chính sách audit đăng nhập tài khoản. | Chính sách này ghi lại và theo dõi các sự kiện liên quan đến đăng nhập tài khoản, giúp phát hiện và ngăn chặn các nỗ lực đăng nhập bất thường hoặc không hợp lệ. |*Audit Account Logon Events** **Success:** Ghi lại các lần đăng nhập thành công của người dùng vào tài khoản.----**Failure:** Ghi lại các lần đăng nhập không thành công.  | ![](https://img001.prntscr.com/file/img001/yL0XAupeScuhUSprNnXrtw.png) |
| 43   | Configure Account Management audit policy. <br> Cấu hình chính sách audit quản lý tài khoản. | Giám sát và ghi lại các thay đổi liên quan đến tài khoản người dùng như tạo, xóa, hoặc sửa đổi tài khoản, giúp quản lý và kiểm tra hoạt động tài khoản hiệu quả. | **Audit Account Management** **Success**: Ghi lại các hành động quản lý tài khoản (tạo, xóa, sửa đổi). **********   **Failure:** Ghi lại khi một hành động quản lý tài khoản không thành công. | Ở hết trong Audit Policy |
| 44   | Configure Logon/Logoff audit policy. <br> Cấu hình chính sách audit đăng nhập/đăng xuất. | Giám sát và ghi lại các sự kiện đăng nhập và đăng xuất của người dùng trên hệ thống, giúp theo dõi và bảo vệ khỏi các hành vi đăng nhập trái phép. | **Audit Logon Events** --**Success:** Ghi lại các lần đăng nhập thành công vào hệ thống. <br>**Failure:** Ghi lại các lần đăng nhập không thành công. |Ở hết trong Audit Policy  |
| 45   | Configure Policy Change audit policy & Privilege Use audit policy. <br> Cấu hình chính sách audit thay đổi chính sách và sử dụng đặc quyền. | Theo dõi và ghi lại những thay đổi trong chính sách hệ thống và cách các đặc quyền được sử dụng, giúp phát hiện các thay đổi không mong muốn hoặc hành vi lạm dụng quyền hạn. | **Audit Policy Change** <br>**Success:** Ghi lại các thay đổi trong chính sách bảo mật.   |Ở hết trong Audit Policy |
| 46   | Configure Event Log retention method and size. <br> Cấu hình phương thức và dung lượng lưu trữ nhật ký sự kiện. | Đảm bảo các sự kiện được lưu trữ đủ lâu để phân tích nhưng không chiếm quá nhiều dung lượng hệ thống, giúp cân bằng giữa khả năng phân tích và hiệu suất hệ thống. | **Event Viewer -> Navigate to Event Viewer tree → Windows Logs, right-click Security and select Properties.**<br> Make sure Enable logging is selected. <br>**In the Maximum log size field**, specify the size you need. <br>. **If selected, change the retention method to Overwrite events as needed (oldest events first).** | ![](https://img001.prntscr.com/file/img001/pF5cc4MQTtuPix2ZEXnRsA.png) |
| 47   | Configure log shipping (e.g. to Splunk).| | |  |
| 48   | Disable or uninstall unused services. <br> Vô hiệu hóa hoặc gỡ bỏ các dịch vụ không sử dụng. | Các dịch vụ không sử dụng có thể trở thành điểm yếu bảo mật, do đó cần vô hiệu hóa hoặc gỡ bỏ để giảm thiểu rủi ro tấn công. | To turn off services in windows: <br>Click the Start Menu<br >Type services.msc into the search field<br>Open the Services app<br>Find a service you want to disable, and double click<br>Click stop | ![Image48](https://img001.prntscr.com/file/img001/XU8riVWXSGucb2ZYsmn0Vg.png) |
| 49   | Configure user rights to be as secure as possible: Follow the Principle of Least Privilege. <br> Cấu hình quyền người dùng an toàn nhất có thể: Tuân theo nguyên tắc quyền hạn tối thiểu. | Chỉ cấp các quyền cần thiết cho người dùng để giảm nguy cơ tấn công bằng cách hạn chế quyền truy cập không cần thiết. | Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignments:<br>Deny access to this computer from the network<br>Deny log on as a batch job<br>Deny log on as a service<br>Deny log on through Remote Desktop Services | ![Image49](https://img001.prntscr.com/file/img001/AIos6X5jTkqat5Ri4O4gXQ.png) |
| 50   | Ensure all volumes are using the NTFS file system. <br> Đảm bảo tất cả các ổ đĩa đang sử dụng hệ thống tệp NTFS. | NTFS cung cấp các tính năng bảo mật tốt hơn so với FAT, như quyền truy cập tệp và mã hóa, giúp bảo vệ dữ liệu tốt hơn. ||![](https://img001.prntscr.com/file/img001/-vwig2z6SkOfgxF9pAihLQ.png) |
| 51   | Configure file system as well as registry permissions. <br> Cấu hình quyền cho hệ thống tệp và registry. | Đảm bảo chỉ những người dùng có quyền hạn chính xác mới có thể truy cập và chỉnh sửa tệp tin, cũng như registry, bảo vệ hệ thống khỏi các thay đổi không mong muốn. |  | ![Image51](https://img001.prntscr.com/file/img001/izBcFpquSSikn1_3fQk26A.png)<hr> ![](https://img001.prntscr.com/file/img001/LzwO4L1sR0ame5MvboWdAg.png) |
| 52   | Disallow remote registry access if not required. <br> Không cho phép truy cập registry từ xa nếu không cần thiết. | Tắt quyền truy cập từ xa vào registry để tránh các cuộc tấn công hoặc truy cập trái phép vào hệ thống qua mạng. | Ta tìm kiếm `service` và tắt nó đi! |![](https://img001.prntscr.com/file/img001/-ttTfRALRGGkIttkrVunew.png) |
| 53   | Install and enable anti-spyware and antivirus software. <br> Cài đặt và bật phần mềm chống gián điệp và chống virus. | Cần cài đặt và kích hoạt phần mềm bảo mật để bảo vệ hệ thống khỏi phần mềm độc hại và các cuộc tấn công bảo mật từ bên ngoài. |  | ![Image54](https://img001.prntscr.com/file/img001/D6X_x_rNQHKAzbR4lqyfkg.png) |

