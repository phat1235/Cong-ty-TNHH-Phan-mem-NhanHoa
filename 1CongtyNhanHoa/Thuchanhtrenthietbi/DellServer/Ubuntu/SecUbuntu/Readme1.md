
## 1. CẬP NHẬT VÀ BẢO TRÌ HỆ THỐNG

|  | Guidance                                                                                          | Câu lệnh hoặc phương pháp                                                                                       | Ý nghĩa                                                                                                           | Demo |
|------|---------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------|------|
| 1    | **Update your package list and upgrade your OS** <br> Cập nhật danh sách gói và nâng cấp hệ điều hành.  | **Phương pháp 1:** `sudo apt update && sudo apt upgrade` <br> **Phương pháp 2:** Dùng `unattended-upgrades` để tự động cập nhật: <br> `sudo apt install unattended-upgrades` <br> `sudo dpkg-reconfigure --priority=low unattended-upgrades` <br> [detail unattended-upgrade](https://github.com/phat1235/Cong-ty-TNHH-Phan-mem-NhanHoa/blob/main/1CongtyNhanHoa/Thuchanhtrenthietbi/DellServer/Ubuntu/SecUbuntu/Update%20your%20packet%20list%20and%20upgrade%20you%20OS.md) | Phương pháp 1 giúp cập nhật thủ công các gói. <br>Phương pháp 2 đảm bảo hệ thống tự động cập nhật để luôn bảo mật.   | <img src = "https://img001.prntscr.com/file/img001/nMFjseaDRx6j9Pf9JD1p1A.png" width="100000000 "> ![](https://img001.prntscr.com/file/img001/39H39nApQUqGtO-jzT1emw.png) |
| 2    | **Remove unnecessary packages** <br> Loại bỏ các gói không cần thiết.                                  | **Phương pháp 1:** `sudo apt autoremove` <br> **Phương pháp 2:** Sử dụng `deborphan` để tìm và xóa các thư viện không còn được sử dụng: <br> `sudo apt install deborphan` <br> `sudo deborphan`  <br> [detail remove unnecessary packages](https://github.com/phat1235/Cong-ty-TNHH-Phan-mem-NhanHoa/blob/main/1CongtyNhanHoa/Thuchanhtrenthietbi/DellServer/Ubuntu/SecUbuntu/Remove%20unnecessary%20packages.md)    |Cải thiện hiệu suất <br> ---Giảm rủi ro bảo mật  <br>  ------Dễ dàng quản lý | ![](https://img001.prntscr.com/file/img001/TWelRqwcTFiRmqYuv87CvQ.png)  |
## 2. Quản lý Tài khoản và Mật khẩu
|  | Guidance                                                                                          | Câu lệnh hoặc phương pháp                                                                                       | Ý nghĩa                                                                                                           | Demo |
|------|---------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------|------|
| 4    | **Detect weak passwords with John the Ripper** <br> Phát hiện mật khẩu yếu với John the Ripper.         | **Phương pháp 1:** `john --wordlist=/path/to/wordlist /etc/shadow` <br> [detail Detect weak passwords with John the Ripper](https://github.com/phat1235/Cong-ty-TNHH-Phan-mem-NhanHoa/blob/main/1CongtyNhanHoa/Thuchanhtrenthietbi/DellServer/Ubuntu/SecUbuntu/John%20the%20Ripper.md) | John giúp phát hiện mật khẩu yếu qua dictionary attack. `cracklib-check` kiểm tra ngay lập tức mật khẩu được nhập. | ![](https://img001.prntscr.com/file/img001/0aNJU86LSzSSHnBDX2agmw.png)![](	https://img001.prntscr.com/file/img001/GlwpxLJZRi6hMLfTZnn8ng.png)![](https://img001.prntscr.com/file/img001/C2lRXY8fR_63x6SpmotJRw.png)|
| 5    | **Verify no accounts have empty passwords** <br> Kiểm tra xem có tài khoản nào không có mật khẩu không. | **Liệt kê all:** `awk -F: '($2 == "!") {print}' /etc/shadow` <br> $2 = username <br> `!` = empty-pass <br> [detail acc empty pass](https://github.com/phat1235/Cong-ty-TNHH-Phan-mem-NhanHoa/blob/main/1CongtyNhanHoa/Thuchanhtrenthietbi/DellServer/Ubuntu/SecUbuntu/Verify%20no%20accounts%20have%20empty%20passwords.md) | Giúp đảm bảo rằng tất cả các tài khoản đều có mật khẩu, tránh tình trạng bảo mật yếu do tài khoản trống mật khẩu. |![](https://img001.prntscr.com/file/img001/d5c1GQryR5O5_YCZic1kDg.png) |
| 6    | **Set password rules** <br> Thiết lập quy tắc mật khẩu.                                                |  Chỉnh sửa `/etc/pam.d/common-password` để thiết lập độ dài và độ phức tạp của mật khẩu: <br> `password requisite pam_pwquality.so retry=3 minlen=8` <br> [pass rule](https://github.com/phat1235/Cong-ty-TNHH-Phan-mem-NhanHoa/blob/main/1CongtyNhanHoa/Thuchanhtrenthietbi/DellServer/Ubuntu/SecUbuntu/Set%20password%20rules.md)| Quy định mật khẩu phức tạp hơn và thay đổi định kỳ giúp tăng cường bảo mật, giảm thiểu nguy cơ bị tấn công mật khẩu. |![](https://img001.prntscr.com/file/img001/NsX4EPIuQjq8UOhI6EbE9g.png) ![](https://img001.prntscr.com/file/img001/_lDX4TTNQFOxHjDhB2DLJw.png) |
| 7    | **Set password expiration in login.defs** <br> Thiết lập thời gian hết hạn mật khẩu trong `login.defs`. | **Phương pháp 1:** Chỉnh sửa trực tiếp tệp `/etc/login.defs`: <br> `PASS_MAX_DAYS 90` <br> **Phương pháp 2:** Sử dụng `chage` cho từng người dùng cụ thể: <br> `sudo chage -M 90 username` <br> [detail Set password expiration](https://github.com/phat1235/Cong-ty-TNHH-Phan-mem-NhanHoa/blob/main/1CongtyNhanHoa/Thuchanhtrenthietbi/DellServer/Ubuntu/SecUbuntu/Set%20password%20expiration%20in%20login.defs.md)| Đặt thời gian mật khẩu hết hạn để buộc người dùng thay đổi mật khẩu sau một khoảng thời gian nhất định.             | ![](https://img001.prntscr.com/file/img001/kIP6s0D5QPmkLi9b5OESLA.png)![](https://img001.prntscr.com/file/img001/NUPUZ5a2Rl-WjLPCQq8RvA.png)![](https://img001.prntscr.com/file/img001/5PZ2TZGASGufx1bVLWITHQ.png)|
| 8   | **Lock user accounts after failed attempts with Fail2Ban** <br> Khóa tài khoản sau nhiều lần đăng nhập thất bại với Fail2Ban. | Cài đặt Fail2Ban: <br> `sudo apt install fail2ban` <br> Chỉnh sửa tệp `/etc/fail2ban/jail.conf`: <br> `[sshd]` <br> `enabled = true` <br> Và chỉnh các thông số<br> Xem nhật ký Fail2Ban: <br> `sudo fail2ban-client status sshd` |Fail2Banđược sử dụng để bảo vệ máy chủ khỏi các cuộc tấn công brute force bằng cách khóa các tài khoản sau một số lần đăng nhập không thành công. | ![](https://camo.githubusercontent.com/03c4cae557f712ef96ca9d70ce6f1dc746321d5030afce8be002bc47554c536f/68747470733a2f2f696d673030312e70726e747363722e636f6d2f66696c652f696d673030312f683072385178585452327178417032467345446f52672e706e67) ![](https://camo.githubusercontent.com/57aaf272a72a44baa2fdb4f98d8dfc01ff4c6f92d15fa406a76c25bf0ee88c8c/68747470733a2f2f696d673030312e70726e747363722e636f6d2f66696c652f696d673030312f374c537041303770536675415333654f676e367961512e706e67) ![](https://camo.githubusercontent.com/fad7dff92a3e5176826943bec105ebb27c708d3fce0560d04a4831c928b46c20/68747470733a2f2f696d673030312e70726e747363722e636f6d2f66696c652f696d673030312f544a30497334793754344f644d2d7a5038334a7368772e706e67)|
| 9   | **Disable or remove all user accounts that haven't been active in the last 3 months** <br> Vô hiệu hóa hoặc xóa tất cả các tài khoản người dùng không hoạt động trong 3 tháng qua. | **Phương pháp thủ công:** Kiểm tra tài khoản người dùng không hoạt động với `lastlog`: <br> `lastlog -b 90` <br> **Sau đó ** Vô hiệu hóa tài khoản với `usermod`: <br> `sudo usermod -L user_name` | Vô hiệu hóa hoặc xóa tài khoản người dùng không hoạt động giúp giảm thiểu nguy cơ bị tấn công qua tài khoản không bảo mật. | ![](https://example.com/disable_inactive.png) |
| 10   | **Make sure that membership to both the admin and superadmin group is restricted to as few users as possible** <br> Đảm bảo quyền truy cập vào nhóm admin và superadmin chỉ giới hạn cho số ít người dùng cần thiết. |* Kiểm tra danh sách thành viên của các nhóm với `getent`: <br> `getent group admin` <br> `getent group sudo` <br> Sử dụng `usermod` để xóa người dùng khỏi nhóm admin: <br> `sudo deluser user_name sudo` | Giới hạn số lượng người dùng có quyền admin và superadmin để đảm bảo hệ thống chỉ được kiểm soát bởi những người có trách nhiệm. | ![](https://img001.prntscr.com/file/img001/llt33kb7QsSTIcM4Zl1GsA.png) |
## 3. Cấu hình Bảo mật
|  | Guidance                                                                                          | Câu lệnh hoặc phương pháp                                                                                       | Ý nghĩa                                                                                                           | Demo |
|------|---------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------|------|
| 11    | **Disable USB devices (for headless servers)** <br> Vô hiệu hóa thiết bị USB trên máy chủ không màn hình. |<br>`echo '0'  sudo tee /sys/bus/usb/devices/usb*/authorized` <br> để bật lại các cổng usb> <br>`echo '1'  sudo tee /sys/bus/usb/devices/usb*/authorized` <br> để bật lại các cổng usb <br> [detail Disable USB devices](https://github.com/phat1235/Cong-ty-TNHH-Phan-mem-NhanHoa/blob/main/1CongtyNhanHoa/Thuchanhtrenthietbi/DellServer/Ubuntu/SecUbuntu/Disable%20USB%20devices.md)| Ngăn chặn các thiết bị USB để bảo vệ hệ thống khỏi các thiết bị trái phép, đặc biệt trên máy chủ không có màn hình. |![](https://img001.prntscr.com/file/img001/GnsqgG6tTA69KvrAZHTiCg.png) ![](		https://img001.prntscr.com/file/img001/G5dv1wTMTLSTr_LyeTRBfQ.png) |
| 12   | **Configure iptables to block common attacks** <br> Cấu hình iptables để chặn các cuộc tấn công phổ biến. <br> | `sudo iptables -N syn-flood`<br>`sudo iptables -A syn-flood -p tcp --syn -m limit --limit 1/s --limit-burst 4 -j RETURN`<br>`sudo iptables -A syn-flood -j DROP`<br>`sudo iptables -A INPUT -p tcp --syn -j syn-flood`<br>`sudo iptables -L -v -n`  <br> [Detail](https://github.com/phat1235/Cong-ty-TNHH-Phan-mem-NhanHoa/blob/main/1CongtyNhanHoa/Thuchanhtrenthietbi/DellServer/Ubuntu/SecUbuntu/Configure%20iptables%20to%20block%20common%20attacks.md)| Thiết lập firewall bảo vệ khỏi các cuộc tấn công như brute force hay DDoS, tăng cường bảo mật mạng cho máy chủ.     | ![](https://img001.prntscr.com/file/img001/-SwIX_u_RW6UvcLpbLAZ4A.png) |
| 13   | **Set GRUB boot loader password** <br> Đặt mật khẩu cho bộ nạp khởi động GRUB.                      | **Phương pháp 1:** Sử dụng `grub-mkpasswd-pbkdf2` để tạo mật khẩu mã hóa: <br> `sudo grub-mkpasswd-pbkdf2` <br> Tiếp đó chỉnh sửa tệp `/etc/grub.d/40_custom`: <br> `set superusers="admin"` <br> `password_pbkdf2 admin [hashed password]` <br> Sau đó cập nhật GRUB: <br> `sudo update-grub`<br>[Detail](https://github.com/phat1235/Cong-ty-TNHH-Phan-mem-NhanHoa/blob/main/1CongtyNhanHoa/Thuchanhtrenthietbi/DellServer/Ubuntu/SecUbuntu/Set%20GRUB%20boot%20loader%20password.md) | Đặt mật khẩu bảo vệ bộ nạp GRUB giúp ngăn người dùng trái phép truy cập vào hệ điều hành từ giai đoạn khởi động. | ![](https://img001.prntscr.com/file/img001/wVoPCiP9Q8W1xBPSEYdyXA.png)!![](https://img001.prntscr.com/file/img001/2TC0knKCRO2226-dNa4abQ.png)![](https://img001.prntscr.com/file/img001/yV0IjBzpT4uz1NKqiwLCbQ.png) |
| 14   | **Install and configure UFW** <br> Cài đặt và cấu hình tường lửa UFW.                                | **Phương pháp 1:** Cài đặt UFW: <br> `sudo apt install ufw` <br> Bật UFW và cho phép các dịch vụ cụ thể: <br> `sudo ufw allow ssh` <br> `sudo ufw enable` <br> **Phương pháp 2:** Kiểm tra trạng thái UFW: <br> `sudo ufw status` | UFW giúp quản lý tường lửa dễ dàng và bảo mật các cổng truy cập mạng một cách nhanh chóng và hiệu quả.              | ![](https://img001.prntscr.com/file/img001/t1VJobC2SYaqrQ7OkqGnjg.png)![](https://img001.prntscr.com/file/img001/Jkb6GYQ2QrqSt8fBLIPiEg.png) |
| 15   | **Disable telnet** <br> Vô hiệu hóa dịch vụ Telnet.                                                  | **** Tắt Telnet bằng cách dừng dịch vụ: <br> `sudo systemctl stop telnet` <br> `sudo systemctl disable telnet` <br> **Hoặc:** Xóa Telnet khỏi hệ thống: <br> `sudo apt-get remove --purge telnetd openbsd-inetd -y` | Telnet không mã hóa dữ liệu, do đó việc tắt hoặc xóa nó giúp bảo vệ hệ thống khỏi các cuộc tấn công nghe lén dữ liệu. | ![](https://img001.prntscr.com/file/img001/4nAS_233TVSa9ULwgxdSlQ.png) |
| 16   | **Configure sysctl securely** <br> Cấu hình `sysctl` để tăng cường bảo mật.                           | **Phương pháp 1:** Chỉnh sửa tệp `/etc/sysctl.conf`: <br> `net.ipv4.ip_forward=0` <br> `net.ipv4.conf.all.accept_redirects=0` <br> Áp dụng cấu hình ngay lập tức: <br> `sudo sysctl -p` <br>[detail](https://github.com/phat1235/Cong-ty-TNHH-Phan-mem-NhanHoa/blob/main/1CongtyNhanHoa/Thuchanhtrenthietbi/DellServer/Ubuntu/SecUbuntu/Configure%20sysctl%20securely.md)| Tối ưu hóa cài đặt mạng qua `sysctl` giúp tăng cường bảo mật cho hệ thống khỏi các cuộc tấn công trên mạng.         | ![](https://camo.githubusercontent.com/1b16bb179376e2c9eb260721ae42b29d9336035fabb61a09cc1d6def48275e89/68747470733a2f2f696d673030312e70726e747363722e636f6d2f66696c652f696d673030312f755932684f644a6954582d545f456e31516131786e772e706e67)![](https://camo.githubusercontent.com/69b540717879ff29068bf13f48a2ee2419419736370a08cb017cb04636926455/68747470733a2f2f696d673030312e70726e747363722e636f6d2f66696c652f696d673030312f49684d4354764f7252594b6c4e4b6a39356b514b62412e706e67) |
| 17   | **Configure SSH securely** <br> Cấu hình bảo mật cho SSH.                                            | `Port 8888` <br>`Protocol 2`  <br>`PasswordAuthentication no`  <br>`PermitRootLogin no`  <br>`MaxAuthTries 3`  <br> `ClientAliveInterval 300`  <br>`ClientAliveCountMax 2`  <br> [Detail](https://github.com/phat1235/Cong-ty-TNHH-Phan-mem-NhanHoa/blob/main/1CongtyNhanHoa/Thuchanhtrenthietbi/DellServer/Ubuntu/CheckListUbuntu.md)| Cấu hình SSH đúng cách giúp bảo vệ hệ thống khỏi các cuộc tấn công brute force hoặc truy cập trái phép qua SSH.     | ![](https://example.com/ssh_secure.png)  |
### 4. Giám sát và Đánh giá Bảo mật
|  | Guidance                                                                                          | Câu lệnh hoặc phương pháp                                                                                       | Ý nghĩa                                                                                                           | Demo |
|------|---------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------|------|
| 18   | **Configure root user timeout** <br> Cấu hình thời gian hết hạn cho tài khoản root.                   |- Mở file `/etc/profile`<br> - Thêm dòng sau vào cuối file: ```TMOUT=xxx(giây)``` <br> [Detail](https://github.com/phat1235/Cong-ty-TNHH-Phan-mem-NhanHoa/blob/main/1CongtyNhanHoa/Thuchanhtrenthietbi/DellServer/Ubuntu/SecUbuntu/20Configure%20root%20user%20timeout.md)  | Cấu hình thời gian hết hạn giúp bảo vệ tài khoản root khỏi việc truy cập trái phép khi quên đăng xuất.              | ![](https://img001.prntscr.com/file/img001/vd4H7ZROQ4C0AyVN9nhaXg.png) ![](	https://img001.prntscr.com/file/img001/2V9IeM_wQb68RS4105LVZg.png)|
| 19   | **Check for hidden open ports with netstat** <br> Kiểm tra các cổng mở ẩn với `netstat`.              | Liệt kê tất cả các cổng đang mở: <br> `sudo netstat -tuln` <br> [Detail](https://github.com/phat1235/Cong-ty-TNHH-Phan-mem-NhanHoa/blob/main/1CongtyNhanHoa/Thuchanhtrenthietbi/DellServer/Ubuntu/SecUbuntu/21Check%20for%20hidden%20open%20ports%20with%20netstat.md) | Kiểm tra các cổng mở giúp phát hiện các dịch vụ không cần thiết đang chạy và có thể gây nguy cơ bảo mật.             | ![](https://private-user-images.githubusercontent.com/142295328/371068264-626d750a-d967-4069-a89a-f47681e661ae.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3Mjg2MjQ1NDIsIm5iZiI6MTcyODYyNDI0MiwicGF0aCI6Ii8xNDIyOTUzMjgvMzcxMDY4MjY0LTYyNmQ3NTBhLWQ5NjctNDA2OS1hODlhLWY0NzY4MWU2NjFhZS5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjQxMDExJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI0MTAxMVQwNTI0MDJaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT0zYjhhMTNjZDJhMGUyN2NjY2FkN2JhNDgzNTRiMzg1OTE3ZThjM2U4MGI2ZGUzZWJmYmY4YzQ0MjZjMWU1ZGZlJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.pnfno1yjGlPuB-OQHma555rns32ksGHgI39OTXPOvfo) ![](https://img001.prntscr.com/file/img001/Kt796EZwRWe3xP9wZ5_KHQ.png) |
| 20   | **Set root permissions for core system files** <br> Đặt quyền root cho các tệp hệ thống quan trọng.   | **Phương pháp 1:** Đặt quyền cho các tệp nhạy cảm: <br> `sudo chown root:root /path/to/file` <br> `sudo chmod 600 /path/to/file` <br> Kiểm tra quyền hiện tại: <br> `ls -l /path/to/file` | Đảm bảo chỉ có người dùng root có quyền truy cập vào các tệp quan trọng, ngăn chặn sự can thiệp từ người dùng khác. | ![](https://img001.prntscr.com/file/img001/-HvRmopqQiKmqaxoIisE0Q.png)![](https://img001.prntscr.com/file/img001/apn2ZofMT9yN_McwSlAS9g.png) |
| 21   | **Scan for rootkits**                                                       | | |  |
| 22   | **Keep watch for any users logging on under suspicious circumstances** <br> Theo dõi các lần đăng nhập bất thường. | **Phương pháp 1:** Kiểm tra nhật ký đăng nhập với `last` hoặc `lastb`: <br> `last` <br> `lastb` (hiển thị các lần đăng nhập thất bại) <br> **Phương pháp 2:** Sử dụng `auditd` để giám sát hoạt động đăng nhập: <br> `sudo ausearch -m USER_LOGIN` | Theo dõi hoạt động đăng nhập giúp phát hiện các hành vi đáng ngờ, chẳng hạn như đăng nhập từ địa chỉ IP không xác định hoặc các lần đăng nhập thất bại nhiều lần. | ![](https://img001.prntscr.com/file/img001/Jgr9tLkhRX2K7C5GlTVLIA.png) ![](https://img001.prntscr.com/file/img001/PCS6DqWJRv2DOdD3JCPG9A.png) |
| 23   | **Check remote access logs regularly** <br> Kiểm tra nhật ký truy cập từ xa thường xuyên.           | **Phương pháp 1:** Sử dụng lệnh `journalctl` để xem nhật ký SSH: <br> `sudo journalctl -u ssh` <br> `sudo journalctl -u ssh --since "1 hour ago"`  <br> `sudo journalctl -u ssh --since today`<br>`sudo journalctl -u ssh -n 50` <br> **Phương pháp 2:** Sử dụng `grep` để tìm kiếm các sự kiện cụ thể trong nhật ký: <br> `sudo grep "sshd" /var/log/auth.log` | Kiểm tra thường xuyên nhật ký truy cập từ xa giúp phát hiện các dấu hiệu của hành vi xâm nhập trái phép qua SSH.  | ![](https://img001.prntscr.com/file/img001/hZVHmVnrSGOvKpMj0eSkWg.png) |
| 24   | **In case of remote access activity: Make sure that the suspicious activity is flagged and documented** <br> Đảm bảo hoạt động truy cập từ xa  được ghi nhận và đánh dấu. | **Phương pháp 1:** Sử dụng `auditd` để tạo các cảnh báo tùy chỉnh cho các hành vi đáng ngờ: <br> `auditctl -w /var/log/auth.log -p wa -k suspicious_access` <br>  | Ghi nhận và đánh dấu các hoạt động truy cập từ xa  giúp tạo nhật ký an toàn và dễ dàng theo dõi những vấn đề bảo mật. | Giống như ta làm với giám sát  file quan trọng vậy ![](https://img001.prntscr.com/file/img001/4GZHS7MXRHCXZG_7XOnumg.png) |
| 25   | **Make sure that the suspected account privileges are temporarily frozen** <br> Đảm bảo quyền truy cập của tài khoản bị nghi ngờ được tạm thời đóng băng. | Sử dụng `usermod` để khóa tài khoản: <br> `sudo usermod -L suspicious_user`  Khóa trực tiếp bằng `passwd`: <br> `sudo passwd -l suspicious_user` | Tạm thời đóng băng quyền truy cập của tài khoản bị nghi ngờ giúp ngăn chặn các hành vi bất hợp pháp trước khi điều tra thêm. | ta sử dụng Fail2ban để lock các tài khoản , IP có gắng đăng nhập khi quá số lần cho phép. Số 8|
| 26   | **Check that all user account logins are being recorded** <br> Kiểm tra việc ghi nhận tất cả các lần đăng nhập. | **Phương pháp 1:** Kiểm tra tệp nhật ký `/var/log/auth.log` để xem các lần đăng nhập: <br> `sudo cat /var/log/auth.log` <br> **Phương pháp 2:** Sử dụng `auditd` để giám sát các hoạt động đăng nhập: <br> `auditctl -w /var/log/auth.log -p wa` <br>Hoặc `sudo grep "login" /var/log/auth.log` | Ghi nhận đầy đủ các lần đăng nhập giúp theo dõi các hoạt động truy cập và phát hiện hành vi bất thường nhanh chóng. | ![](https://img001.prntscr.com/file/img001/a-KD84s3SRKdoL0KDyJKZQ.png) |
| 27   | **Check that all system configuration changes are being recorded** <br> Kiểm tra việc ghi nhận mọi thay đổi cấu hình hệ thống. |   |  | nghĩa là đảm bảo rằng mọi thay đổi cấu hình hệ thống được ghi lại đầy đủ. Việc này giúp quản lý, giám sát và bảo mật hệ thống hiệu quả hơn, đồng thời phát hiện các hành động không mong muốn hoặc bất thường để có biện pháp xử lý kịp thời. |
## 5. Quản lý Dịch vụ và Quy trình Khởi động
|  | Guidance                                                                                          | Câu lệnh hoặc phương pháp                                                                                       | Ý nghĩa                                                                                                           | Demo |
|------|---------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------|------|
| 28    | **Check which services are started at boot time** <br> Kiểm tra các dịch vụ khởi động cùng hệ thống.   | Ta sử dụng câu lệnh: `systemctl list-unit-files --type=service --state=enabled` <br> [detail](https://github.com/phat1235/Cong-ty-TNHH-Phan-mem-NhanHoa/blob/main/1CongtyNhanHoa/Thuchanhtrenthietbi/DellServer/Ubuntu/SecUbuntu/Check%20which%20services%20are%20started%20at%20boot%20time.md) | Giúp xác định các dịch vụ không cần thiết có thể bị vô hiệu hóa để giảm thiểu lỗ hổng bảo mật.                      |![](https://img001.prntscr.com/file/img001/JjS2rpqfRTKN3-VQL3YQyg.png) ![](https://img001.prntscr.com/file/img001/pMNAv2NYTwSlECFsDg0dCA.png)|
| 29   | **Ensure regular users cannot change system startup configuration** <br> Đảm bảo người dùng thường không thể thay đổi cấu hình khởi động. | **Phương pháp 1:** Đặt quyền truy cập chỉ dành cho root cho các tệp cấu hình khởi động: <br> `sudo chmod 600 /etc/systemd/system/*.service` <br> **Phương pháp 2:** Sử dụng `sudo` để giới hạn quyền truy cập của người dùng: <br> `sudo visudo` <br> Thêm dòng: `user_name ALL=(ALL) ALL, !/usr/sbin/service` | Ngăn chặn người dùng thường thay đổi cấu hình khởi động để đảm bảo tính ổn định và bảo mật của hệ thống.            | ![](	https://img001.prntscr.com/file/img001/gqZjSJnRSHG_EISBMJCNGw.png)![](	https://img001.prntscr.com/file/img001/H_ELTvVfRki6esreVGPAtw.png) |
# 6. Quy trình và Chính sách Bảo mật
|  | Guidance                                                                                          | Câu lệnh hoặc phương pháp                                                                                       | Ý nghĩa                                                                                                           | Demo |
|------|---------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------|------|
| 30   | **Evaluate event log monitoring process** <br> Đánh giá quy trình giám sát nhật ký sự kiện.        | Đánh giá quy trình giám sát giúp tối ưu hóa việc theo dõi các sự kiện quan trọng và phát hiện sớm các bất thường trong hệ thống.|  | ![](https://example.com/logwatch.png) |
| 31   | **Evaluate server configuration control process** <br> Đánh giá quy trình kiểm soát cấu hình máy chủ. |  | Đánh giá quy trình quản lý cấu hình giúp đảm bảo tính toàn vẹn của hệ thống và ngăn chặn các thay đổi không mong muốn. | Đây (kiểm toán) là một bước quan trọng trong quản lý an ninh và hiệu suất hệ thống. Quy trình này giúp xác định và đảm bảo rằng cấu hình máy chủ tuân thủ các tiêu chuẩn bảo mật và chính sách nội bộ. Bằng cách kiểm tra và so sánh cấu hình hiện tại với các yêu cầu đã định, tổ chức có thể phát hiện và khắc phục các lỗ hổng bảo mật, đảm bảo rằng các dịch vụ đang hoạt động ổn định và an toàn. Điều này cũng giúp duy trì tính khả dụng và tin cậy của hệ thống. |
| 32   | **Check event log monitoring is properly configured** <br> Kiểm tra cấu hình giám sát nhật ký sự kiện. | Kiểm tra cấu hình `rsyslog`: <br> `sudo cat /etc/rsyslog.conf` <br>  Kiểm tra all cấu hình auditd nếu ta dùng nó| Đảm bảo cấu hình giám sát nhật ký sự kiện được thiết lập đúng cách để theo dõi mọi thay đổi quan trọng trên hệ thống. |Điều này đảm bảo rằng tất cả các sự kiện quan trọng, như đăng nhập, thay đổi cấu hình và truy cập vào tệp nhạy cảm, đều được ghi lại chính xác. Cấu hình đúng sẽ giúp phát hiện và phản ứng kịp thời với các hành vi đáng ngờ, giảm thiểu rủi ro bảo mật. Hơn nữa, việc giám sát nhật ký hỗ trợ trong việc tuân thủ các quy định và tiêu chuẩn bảo mật, giúp tổ chức duy trì một môi trường an toàn và minh bạch. |
| 33   | **Make sure that there is a process in place for changing system configurations** <br> Đảm bảo có quy trình thay đổi cấu hình hệ thống. | **Phương pháp 1:** Sử dụng hệ thống quản lý cấu hình như `Ansible`, `Puppet`, hoặc `Chef`: <br> `ansible-playbook config_change.yml` <br> **Phương pháp 2:** Xác định quy trình kiểm tra thay đổi qua các tập tin nhật ký và cảnh báo hệ thống. | Đảm bảo quy trình thay đổi cấu hình giúp ngăn chặn những thay đổi không mong muốn hoặc không được kiểm soát.      | Đảm bảo có quy trình thay đổi cấu hình hệ thống là việc thiết lập và duy trì các quy tắc, thủ tục để quản lý sự thay đổi. Điều này bao gồm việc xác định rõ ai có quyền thay đổi, cách thức thực hiện thay đổi, và cách ghi lại các thay đổi. Quy trình này giúp tăng cường bảo mật, giảm rủi ro lỗi do cấu hình sai, và đảm bảo rằng hệ thống luôn hoạt động ổn định và đáng tin cậy. Việc có quy trình rõ ràng cũng giúp phát hiện và khắc phục nhanh chóng các vấn đề phát sinh từ các thay đổi cấu hình. |

 # 6. Quét và Phát hiện Lỗ hổng
 |  | Guidance                                                                                          | Câu lệnh hoặc phương pháp                                                                                       | Ý nghĩa                                                                                                           | Demo |
|------|---------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------|------|
| 34   | **Run a full system anti-virus scan** <br> Chạy quét toàn bộ hệ thống bằng phần mềm diệt virus.        | **Phương pháp 1:** Cài đặt và chạy `ClamAV` để quét virus: <br> `sudo apt install clamav` <br> `sudo clamscan -r /` <br> **Phương pháp 2:** Sử dụng các phần mềm diệt virus khác như `Sophos` hoặc `F-Prot`. | Quét toàn bộ hệ thống giúp phát hiện và loại bỏ các phần mềm độc hại tiềm ẩn trên máy chủ.                         | ![](	https://img001.prntscr.com/file/img001/w2aCr8jlRomgY591S8rWrQ.png) |
| 35   | **Review your server firewall security settings and make sure everything is properly configured** <br>  |  Kiểm tra cấu hình tường lửa đảm bảo rằng hệ thống chỉ mở các cổng cần thiết, giúp ngăn chặn truy cập trái phép.   |   |  ![](https://img001.prntscr.com/file/img001/oe2Uo272RZuI1eH6Z75nGw.png)|
| 36   | **Detect all world-writable files** <br> Phát hiện các tệp có quyền ghi đối với tất cả mọi người.       | **Ta sử dụng câu lệnh:** `find / -type d \( -perm -g+w -or -perm -o+w \) -exec ls -adl {} \;` <br> [Detail](https://github.com/phat1235/Cong-ty-TNHH-Phan-mem-NhanHoa/blob/main/1CongtyNhanHoa/Thuchanhtrenthietbi/DellServer/Ubuntu/SecUbuntu/Detect%20all%20world-writable%20files.md)  | Tìm các tệp có thể bị ghi bởi bất kỳ ai để hạn chế nguy cơ bảo mật do các tệp không an toàn.                         | ![](https://img001.prntscr.com/file/img001/Xxy2gNb4TRuR4osZaQws1Q.png)![](https://img001.prntscr.com/file/img001/1FFR0DgASVi6z82iE9mlHg.png)![](https://img001.prntscr.com/file/img001/deEFCIyRRuKuP_21ehw0XA.png)![](https://img001.prntscr.com/file/img001/QYvMPVqhTjCDo1vbjQ1scA.png) |
